<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <title>Casa del Gelato</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="manifest" href="manifest.json">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="icon" href="favicon.png">
  <link rel="apple-touch-icon" href="icon-192.png">

  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;margin:0;background:#f6f6f7;color:#111}
    header{text-align:center;padding:22px}

    /* üîù BARRA FISSA + HOME */
    #top-fixed-bar {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 55px;
      display: flex;
      justify-content: center;
      align-items: center;
      background: white;
      border-bottom: 1px solid #ddd;
      z-index: 9999;
    }

    .home-btn {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 17px;
        color: #444;
        text-decoration: none;
    }

    .home-btn img {
        width: 28px;
        height: 28px;
    }

    /* spazio per far scendere il contenuto */
    #top-fixed-spacer {
      height: 55px;
      width: 100%;
    }
    /* Tasto Lavora con Noi (solo in index) */
.jobs-btn {
    position: absolute;
    left: 12px;
    top: 13px;
    padding: 6px 10px;
    background: #ff7a00;
    color: white;
    font-size: 14px;
    border-radius: 10px;
    text-decoration: none;
    font-weight: 600;
    z-index: 9999;
}

    /* LANGUAGE MENU */
    #lang-toggle{
      position:fixed; 
      top:14px; 
      right:14px;
      padding:6px 12px;
      border-radius:12px;
      background:white;
      border:1px solid #ddd;
      cursor:pointer; 
      font-size:18px;
      z-index:10000;
    }

    #lang-menu{
      position:fixed; 
      top:50px; 
      right:14px;
      background:#fff;
      padding:6px 0;
      border-radius:10px;
      box-shadow:0 6px 20px rgba(0,0,0,0.12);
      display:none;
      z-index:10001;
    }

    #lang-menu button{
      padding:10px 16px;
      border:none;
      background:transparent;
      cursor:pointer;
      font-size:15px;
      text-align:left;
      width:100%;
    }

    #lang-menu button:hover{background:#f2f2f2;}

    /* BUTTONS */
    .menu-section{padding:22px;text-align:center}
    .btn{
      display:block;width:240px;text-align:center;
      padding:12px 14px;border-radius:12px;background:#ff7a00;color:#fff;
      text-decoration:none;margin:14px auto;font-size:17px;font-weight:600;
    }

    /* CARDS */
    .shop-card {
      background:white;
      padding:16px;
      border-radius:14px;
      margin:14px auto;
      max-width:330px;
      box-shadow:0 2px 6px rgba(0,0,0,0.08);
      text-align:left;
    }
    .shop-card b {font-size:16px;margin-bottom:4px;display:block;}
    .shop-card a {text-decoration:none;margin-top:4px;display:block;font-size:15px;color:#007aff;}

    /* WHATSAPP */
    #whatsapp-btn {
      position:fixed;
      right:18px;
      bottom:18px;
      background:#25D366;
      color:white;
      padding:14px 18px;
      border-radius:50%;
      font-size:24px;
      text-decoration:none;
      z-index:9999;
      box-shadow:0 4px 14px rgba(0,0,0,0.25);
    }
  </style>
</head>

<body>

<!-- üîù BARRA FISSA -->
<div id="top-fixed-bar">

  <a href="lavora-con-noi.html" class="jobs-btn">
    üíº Lavora con Noi
</a>

    <a href="index.html" class="home-btn">
        <img src="tastohome.png" alt="home">
        <span>Home</span>
    </a>
</div>

<div id="top-fixed-spacer"></div>

<!-- TASTO DISISCRIVITI -->
<div style="text-align:center; margin-top:80px;">
<button onclick="disiscriviti()"
style="background:#ff3b30; color:white; padding:12px 20px; border:none; border-radius:12px; font-size:16px;">
‚ùå Disiscriviti
</button>
</div>

<!-- LANGUAGE -->
<div id="lang-toggle">üáÆüáπ ‚ñæ</div>
<div id="lang-menu">
  <button class="lang-btn" data-lang="it">Italiano</button>
  <button class="lang-btn" data-lang="en">English</button>
  <button class="lang-btn" data-lang="de">Deutsch</button>
</div>

<header><h1 data-lang="title">Casa del Gelato</h1></header>


<section class="menu-section">
  <h2 data-lang="create_cup_title">Crea la tua Coppa</h2>
  <p data-lang="create_cup_subtitle">Personalizza la tua coppa come la vuoi tu</p>
  <a id="start-coppa" class="btn" data-lang="create_button">üç® INIZIA</a>
  <a href="cronologia.html" class="btn">Coppe create</a>
</section>

<section class="menu-section">
  <h2 data-lang="contacts">I nostri Locali</h2>

<div class="shop-card">
  <b>Bibione - Viale delle Costellazioni 49</b>
  <a href="tel:043143628">üìû 0431 43628</a>
  <a href="https://www.google.com/maps/place/Viale+delle+Costellazioni+49,+Bibione" target="_blank">üó∫ Apri su Maps</a>
  <a href="https://g.page/r/CYRHvgKQaZHjEBM/review" target="_blank">‚≠ê Scrivi una recensione</a>
</div>

<div class="shop-card">
  <b>Bibione - Viale delle Costellazioni 10</b>
  <a href="tel:0431364365">üìû 0431 364365</a>
  <a href="https://www.google.com/maps/place/Viale+delle+Costellazioni+10,+Bibione" target="_blank">üó∫ Apri su Maps</a>
  <a href="https://g.page/r/CSsHbwS_DqXnEBM/review" target="_blank">‚≠ê Scrivi una recensione</a>
</div>

<div class="shop-card">
  <b>Lignano Sabbiadoro - Via Udine 1</b>
  <a href="tel:04311961783">üìû 0431 1961783</a>
  <a href="https://www.google.com/maps/place/Via+Udine+1,+Lignano+Sabbiadoro" target="_blank">üó∫ Apri su Maps</a>
  <a href="https://g.page/r/CeodtGzi9G76EBM/review" target="_blank">‚≠ê Scrivi una recensione</a>
</div>

<!-- WHATSAPP -->
<a id="whatsapp-btn" href="https://wa.me/393403788846" target="_blank">üí¨</a>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyAEO7AonQeZ9SsgXd1Ymw2NZW-Pg4mI8E8",
    authDomain: "casadelgelato-db282.firebaseapp.com",
    projectId: "casadelgelato-db282",
    storageBucket: "casadelgelato-db282.firebasestorage.app",
    messagingSenderId: "121009770190",
    appId: "1:121009770190:web:81b82b82cc9bdb686cca9f"
  };

  firebase.initializeApp(firebaseConfig);

  const auth = firebase.auth();
  const db = firebase.firestore();
</script>

<!-- LANGUAGE LOGIC -->
<script>
(function(){
  const FLAGS = { it:"üáÆüáπ", en:"üá¨üáß", de:"üá©üá™" };
  const LANG = {
    it:{title:"Casa del Gelato",create_cup_title:"Crea la tua Coppa",create_cup_subtitle:"Personalizza la tua coppa come la vuoi tu",create_button:"üç® INIZIA",contacts:"I nostri Locali"},
    en:{title:"House of Gelato",create_cup_title:"Create Your Cup",create_cup_subtitle:"Customize your cup",create_button:"üç® START",contacts:"Our Shops"},
    de:{title:"Haus des Gelatos",create_cup_title:"Erstelle deinen Becher",create_cup_subtitle:"Gestalte deinen Becher",create_button:"üç® START",contacts:"Unsere Standorte"}
  };

  const toggle = document.getElementById('lang-toggle');
  const menu = document.getElementById('lang-menu');

  toggle.onclick = () => menu.style.display = menu.style.display=="flex" ? "none" : "flex";

  document.addEventListener('click', e => {
    if(!e.target.closest('#lang-toggle') && !e.target.closest('#lang-menu')) menu.style.display="none";
  });

  function apply(l){
    localStorage.setItem("lang",l);
    document.querySelectorAll("[data-lang]").forEach(el => el.textContent = LANG[l][el.dataset.lang]);
    toggle.textContent = FLAGS[l] + " ‚ñæ";
  }

  const urlParams = new URLSearchParams(window.location.search);
  const urlLang = urlParams.get("lang");
  if (urlLang) localStorage.setItem("lang", urlLang);

  apply(localStorage.getItem("lang") || "it");

  document.querySelectorAll(".lang-btn").forEach(btn =>
    btn.onclick = () => apply(btn.dataset.lang)
  );

  document.getElementById("start-coppa").onclick = () => {
    window.location.href = "crea-coppa.html";
  };
})();
</script>


<script>
if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js")
        .then(() => console.log("SW registrato"))
        .catch(err => console.error("SW errore:", err));
}
</script>

<script>
function disiscriviti() {
    const email = localStorage.getItem("userEmail"); // ‚Üê QUESTA √à QUELLA GIUSTA!
    if (!email) {
        alert("Errore: nessun utente registrato.");
        return;
    }

    let lista = JSON.parse(localStorage.getItem("utentiRegistrati") || "[]");

    const index = lista.findIndex(u => u.email === email);
    if (index === -1) {
        alert("Errore: utente non trovato.");
        return;
    }

    lista[index].registrato = false;
    lista[index].disiscritto = true;
    lista[index].dataDisiscrizione = new Date().toLocaleString("it-IT");

    localStorage.setItem("utentiRegistrati", JSON.stringify(lista));

    // elimina login
    localStorage.removeItem("userEmail");
    localStorage.setItem("userLogged", "0");

    alert("‚ùå Hai cancellato la registrazione.");
    window.location.href = "index.html";
}
</script>

</body>
</html>